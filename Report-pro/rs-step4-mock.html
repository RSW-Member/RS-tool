<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RS-Reporter Pro - å ±å‘Šæ›¸ä½œæˆ</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&family=Bebas+Neue&display=swap');
:root{
  --bg:#0f0f0f;--surface:#191919;--surface2:#222;--border:#2a2a2a;
  --accent:#e8a020;--text:#f0f0f0;--text2:#777;--danger:#ef4444;--ok:#22c55e;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;background:var(--bg);}
body{font-family:'Noto Sans JP',sans-serif;color:var(--text);max-width:480px;margin:0 auto;min-height:100vh;}

/* â”€â”€â”€ ãƒ˜ãƒƒãƒ€ãƒ¼ â”€â”€â”€ */
.hdr{background:#000;border-bottom:2px solid var(--accent);padding:10px 16px;display:flex;align-items:center;gap:10px;position:sticky;top:0;z-index:100;}
.hdr-logo{font-family:'Bebas Neue',sans-serif;font-size:20px;color:var(--accent);letter-spacing:2px;line-height:1;}
.hdr-sub{font-size:10px;color:var(--text2);margin-top:1px;}
.hdr-right{margin-left:auto;font-size:11px;color:var(--text2);}

/* â”€â”€â”€ ç”»é¢åˆ‡æ›¿ â”€â”€â”€ */
.screen{display:none;flex-direction:column;min-height:calc(100vh - 48px);}
.screen.active{display:flex;}

/* â”€â”€â”€ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â”€â”€â”€ */
.form-body{padding:16px;display:flex;flex-direction:column;gap:0;padding-bottom:100px;}
.field{border-left:3px solid var(--accent);padding:14px 14px 14px 12px;margin-bottom:1px;background:var(--surface);}
.field:first-child{border-radius:12px 12px 0 0;}
.field:last-child{border-radius:0 0 12px 12px;margin-bottom:16px;}
.field-label{font-size:11px;font-weight:700;color:var(--text2);margin-bottom:8px;display:flex;align-items:center;gap:6px;}
.field-label .badge{font-size:9px;padding:1px 6px;border-radius:100px;background:rgba(232,160,32,.15);color:var(--accent);font-weight:700;}
.field-label .opt{font-size:9px;color:var(--text2);font-weight:400;}

/* ãƒãƒƒãƒ—é¸æŠ */
.chips{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px;}
.chip{padding:7px 14px;border-radius:100px;font-size:13px;font-weight:700;border:2px solid var(--border);background:#111;color:var(--text2);cursor:pointer;font-family:inherit;transition:all .15s;white-space:nowrap;}
.chip.on{border-color:var(--accent);background:rgba(232,160,32,.15);color:var(--accent);}
.chip.on.c-multi{border-color:var(--accent);}

/* ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› */
.finput{width:100%;background:#111;border:1.5px solid var(--border);border-radius:10px;padding:11px 12px;font-size:13px;color:var(--text);font-family:inherit;outline:none;transition:border-color .2s;}
.finput:focus{border-color:rgba(232,160,32,.5);}
.finput::placeholder{color:#444;}
textarea.finput{resize:none;line-height:1.7;}

/* æ•°å€¤å…¥åŠ›è¡Œ */
.num-row{display:flex;gap:10px;align-items:center;}
.num-wrap{display:flex;align-items:center;gap:6px;flex:1;}
.num-wrap .finput{text-align:right;}
.num-unit{font-size:12px;color:var(--text2);white-space:nowrap;}

/* ä¸‹åœ° ã‚ã‚Š/ãªã— */
.yn-row{display:flex;gap:8px;margin-bottom:8px;}
.yn-btn{padding:7px 20px;border-radius:100px;font-size:13px;font-weight:700;border:2px solid var(--border);background:#111;color:var(--text2);cursor:pointer;font-family:inherit;transition:all .15s;}
.yn-btn.on{border-color:var(--accent);background:rgba(232,160,32,.15);color:var(--accent);}

/* ã‚«ãƒ©ãƒ¼ãƒ‰ãƒƒãƒˆ */
.color-chip{display:flex;align-items:center;gap:6px;padding:7px 14px;border-radius:100px;font-size:12px;font-weight:700;border:2px solid var(--border);background:#111;color:var(--text2);cursor:pointer;font-family:inherit;transition:all .15s;white-space:nowrap;}
.color-chip.on{border-color:var(--accent);background:rgba(232,160,32,.15);color:var(--accent);}
.cdot{width:10px;height:10px;border-radius:50%;flex-shrink:0;}

/* ä¾‹æ–‡ãƒœã‚¿ãƒ³ */
.ex-btn{font-size:11px;color:var(--accent);background:transparent;border:none;cursor:pointer;font-family:inherit;padding:4px 0;text-decoration:underline;display:block;margin-top:4px;}

/* â”€â”€â”€ å›ºå®šãƒ•ãƒƒã‚¿ãƒ¼ãƒœã‚¿ãƒ³ â”€â”€â”€ */
.fixed-btn{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:480px;padding:12px 16px;background:rgba(15,15,15,.95);backdrop-filter:blur(10px);border-top:1px solid var(--border);z-index:50;}
.preview-btn{width:100%;padding:16px;background:var(--accent);color:#000;border:none;border-radius:12px;font-size:17px;font-weight:900;font-family:inherit;cursor:pointer;transition:opacity .15s;}
.preview-btn:active{opacity:.85;}

/* â”€â”€â”€ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ â”€â”€â”€ */
.preview-body{padding:16px;display:flex;flex-direction:column;gap:12px;padding-bottom:180px;}
.send-text-box{background:#111;border:1px solid var(--border);border-radius:12px;padding:14px;font-size:13px;line-height:1.9;color:var(--text);white-space:pre-wrap;word-break:break-all;font-family:'Noto Sans JP',sans-serif;}
.send-section-title{font-size:11px;font-weight:700;color:var(--text2);margin-bottom:6px;padding:0 2px;display:flex;align-items:center;gap:6px;}
.send-section-title::before{content:'';width:3px;height:10px;background:var(--accent);border-radius:2px;}
.steps-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;}
.steps-title{font-size:12px;font-weight:900;color:var(--accent);margin-bottom:8px;}
.step-row{font-size:12px;color:var(--text2);margin-bottom:4px;display:flex;align-items:flex-start;gap:6px;}
.step-num{color:var(--accent);font-weight:700;flex-shrink:0;}
.fixed-actions{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:100%;max-width:480px;padding:10px 16px;background:rgba(15,15,15,.95);backdrop-filter:blur(10px);border-top:1px solid var(--border);z-index:50;display:flex;flex-direction:column;gap:8px;}
.act-btn{width:100%;padding:15px;border-radius:12px;font-size:15px;font-weight:900;font-family:inherit;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;transition:all .15s;}
.act-btn:active{opacity:.85;}
.btn-copy{background:var(--accent);color:#000;border:none;}
.btn-zip {background:#222;color:var(--text);border:1.5px solid var(--border);}
.btn-zip:active{background:#2a2a2a;}
.btn-back{background:transparent;color:var(--text2);border:1.5px solid var(--border);padding:11px;font-size:13px;}
.btn-delete{background:transparent;color:var(--danger);border:1.5px solid rgba(239,68,68,.3);padding:11px;font-size:13px;}

/* ã‚³ãƒ”ãƒ¼å®Œäº†ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ */
.copied-flash{background:var(--ok);color:#000;border-color:var(--ok);}

/* ãƒˆãƒ¼ã‚¹ãƒˆ */
.toast{position:fixed;bottom:220px;left:50%;transform:translateX(-50%) translateY(12px);background:rgba(232,160,32,.97);color:#000;padding:12px 28px;border-radius:100px;font-size:13px;font-weight:700;opacity:0;transition:all .25s;z-index:999;white-space:nowrap;pointer-events:none;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
</style>
</head>
<body>

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<div class="hdr">
  <div>
    <div class="hdr-logo">RS-Reporter Pro</div>
    <div class="hdr-sub">è·äººã®3ç§’ã‚’ã€ä¼šç¤¾ã®è³‡ç”£ã«å¤‰ãˆã‚‹</div>
  </div>
  <div class="hdr-right" id="hdr-right">å…¥åŠ›ä¸­</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN A: å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen active" id="screen-input">
<div class="form-body">

  <!-- æ“ä½œã‚¬ã‚¤ãƒ‰ -->
  <div style="background:rgba(232,160,32,.07);border:1px solid rgba(232,160,32,.2);border-radius:12px;padding:13px 14px;margin-bottom:14px;">
    <div style="font-size:12px;font-weight:900;color:var(--accent);margin-bottom:8px;">ğŸ“‹ æ“ä½œæ–¹æ³•</div>
    <div style="font-size:11px;color:var(--text2);line-height:2;">
      <div>â‘  æ–½å·¥ç¨®åˆ¥ã‚’é¸ã¶ï¼ˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³ / ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¦ã‚©ãƒ¼ãƒ«ï¼‰</div>
      <div>â‘¡ å„é …ç›®ã‚’å…¥åŠ›ãƒ»é¸æŠã™ã‚‹ï¼ˆä¾‹æ–‡ãƒœã‚¿ãƒ³ã‚‚æ´»ç”¨ï¼‰</div>
      <div>â‘¢ã€Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ç¢ºèªã™ã‚‹ã€ã‚’æŠ¼ã™</div>
      <div>â‘£ ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ â†’ LINEã«è²¼ã‚Šä»˜ã‘</div>
      <div>â‘¤ ZIPã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ â†’ LINEã«æ·»ä»˜ã—ã¦å®Œäº†</div>
    </div>
  </div>

  <!-- æ‹…å½“è€…å -->
  <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;margin-bottom:14px;display:flex;align-items:center;gap:10px;">
    <div style="font-size:13px;">ğŸ‘¤</div>
    <div style="flex:1;">
      <div style="font-size:10px;color:var(--text2);margin-bottom:4px;">æ‹…å½“è€…å</div>
      <input class="finput" id="h-staff" placeholder="ã¬ãƒ¼ã¾ã‚“" style="padding:8px 10px;">
    </div>
  </div>

  <!-- æ–½å·¥ç¨®åˆ¥ -->
  <div class="field" style="border-radius:12px 12px 0 0;">
    <div class="field-label">æ–½å·¥ç¨®åˆ¥</div>
    <div style="display:flex;gap:10px;">
      <button class="yn-btn on" id="type-rs" style="flex:1;padding:12px 8px;font-size:13px;" onclick="setType('rs')">
        ğŸ— ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³
      </button>
      <button class="yn-btn" id="type-rw" style="flex:1;padding:12px 8px;font-size:13px;" onclick="setType('rw')">
        ğŸ§± ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¦ã‚©ãƒ¼ãƒ«
      </button>
    </div>
  </div>

  <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
  <div class="field">
    <div class="field-label">ã‚¿ã‚¤ãƒˆãƒ«</div>
    <div class="chips" id="chips-title">
      <button class="chip" onclick="chipToggle(this,'title',false)">ç„é–¢ã‚¢ãƒ—ãƒ­ãƒ¼ãƒæ–½å·¥</button>
      <button class="chip" onclick="chipToggle(this,'title',false)">é§è»Šå ´æ–½å·¥</button>
      <button class="chip" onclick="chipToggle(this,'title',false)">ã‚¿ã‚¤ãƒ«ãƒ‡ãƒƒã‚­æ–½å·¥</button>
      <button class="chip" onclick="chipToggle(this,'title',false)">å¤–æ§‹æ–½å·¥</button>
    </div>
    <input class="finput" id="title-custom" placeholder="ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰" oninput="syncCustom(this,'title-custom')">
  </div>

  <!-- è¦æ¨¡ãƒ»æ–½å·¥æ—¥æ•° -->
  <div class="field">
    <div class="field-label">è¦æ¨¡</div>
    <div class="num-row">
      <div class="num-wrap" style="flex:3;">
        <input class="finput" id="f-size" type="number" placeholder="25" inputmode="numeric">
        <span class="num-unit">ã¡</span>
      </div>
      <div style="flex:1.5;">
        <div class="field-label" style="margin-bottom:4px;">æ–½å·¥æ—¥æ•°</div>
        <div class="num-wrap">
          <input class="finput" id="f-days" type="number" placeholder="3" inputmode="numeric">
          <span class="num-unit">æ—¥</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ä¸‹åœ°å‡¦ç† -->
  <div class="field">
    <div class="field-label">ä¸‹åœ°å‡¦ç†</div>
    <div class="yn-row">
      <button class="yn-btn on" id="yn-yes" onclick="setYN('yes')">ã‚ã‚Š</button>
      <button class="yn-btn"    id="yn-no"  onclick="setYN('no')">ãªã—</button>
    </div>
    <input class="finput" id="f-base" placeholder="ã‚±ãƒ¬ãƒ³å‡¦ç†ã€ä¸‹åœ°èª¿æ•´ãªã©ï¼ˆä»»æ„ï¼‰">
  </div>

  <!-- ãƒ‘ã‚¿ãƒ¼ãƒ³ -->
  <div class="field">
    <div class="field-label">ãƒ‘ã‚¿ãƒ¼ãƒ³ <span class="opt">è¤‡æ•°å¯</span></div>
    <div class="chips" id="chips-pattern">
      <button class="chip" onclick="chipToggle(this,'pattern',true)">ä¹±å½¢çŸ³èª¿</button>
      <button class="chip" onclick="chipToggle(this,'pattern',true)">ã‚¿ã‚¤ãƒ«èª¿</button>
      <button class="chip" onclick="chipToggle(this,'pattern',true)">ç‰¹æ®Šãƒ»ãƒ­ã‚´</button>
      <button class="chip" onclick="chipToggle(this,'pattern',true)">ãã®ä»–</button>
    </div>
    <input class="finput" id="pattern-custom" placeholder="ãã®ä»–ï¼ˆè‡ªç”±è¨˜è¿°ï¼‰">
  </div>

  <!-- ä»•ä¸Šã’ã‚«ãƒ©ãƒ¼ ãƒ¡ã‚¤ãƒ³ -->
  <div class="field">
    <div class="field-label">ä»•ä¸Šã’ã‚«ãƒ©ãƒ¼ï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰ <span class="opt">è¤‡æ•°å¯</span></div>
    <div class="chips" id="chips-color-main">
      <button class="color-chip" onclick="chipToggle(this,'color-main',true)"><span class="cdot" style="background:#999"></span>ã‚°ãƒ¬ãƒ¼</button>
      <button class="color-chip" onclick="chipToggle(this,'color-main',true)"><span class="cdot" style="background:#222;border:1px solid #555"></span>ãƒ–ãƒ©ãƒƒã‚¯</button>
      <button class="color-chip" onclick="chipToggle(this,'color-main',true)"><span class="cdot" style="background:#e8d5a0"></span>ã‚¤ã‚¨ãƒ­ãƒ¼ãƒ™ãƒ¼ã‚¸ãƒ¥</button>
      <button class="color-chip" onclick="chipToggle(this,'color-main',true)"><span class="cdot" style="background:#c9a882"></span>ãƒŸãƒ«ã‚¯ãƒ†ã‚£ãƒ¼</button>
      <button class="color-chip" onclick="chipToggle(this,'color-main',true)"><span class="cdot" style="background:#e87030"></span>ã‚ªãƒ¬ãƒ³ã‚¸</button>
      <button class="color-chip" onclick="chipToggle(this,'color-main',true)"><span class="cdot" style="background:#5a7a50"></span>ãƒ¢ã‚¹ã‚°ãƒªãƒ¼ãƒ³</button>
    </div>
    <input class="finput" id="color-main-custom" placeholder="ãã®ä»–ã®ã‚«ãƒ©ãƒ¼ï¼ˆä»»æ„ï¼‰">
  </div>

  <!-- ä»•ä¸Šã’ã‚«ãƒ©ãƒ¼ ã‚µãƒ– -->
  <div class="field">
    <div class="field-label">ä»•ä¸Šã’ã‚«ãƒ©ãƒ¼ï¼ˆã‚µãƒ–ï¼‰ <span class="opt">ä»»æ„ãƒ»è¤‡æ•°å¯</span></div>
    <div class="chips" id="chips-color-sub">
      <button class="color-chip" onclick="chipToggle(this,'color-sub',true)"><span class="cdot" style="background:#999"></span>ã‚°ãƒ¬ãƒ¼</button>
      <button class="color-chip" onclick="chipToggle(this,'color-sub',true)"><span class="cdot" style="background:#222;border:1px solid #555"></span>ãƒ–ãƒ©ãƒƒã‚¯</button>
      <button class="color-chip" onclick="chipToggle(this,'color-sub',true)"><span class="cdot" style="background:#e8d5a0"></span>ã‚¤ã‚¨ãƒ­ãƒ¼ãƒ™ãƒ¼ã‚¸ãƒ¥</button>
      <button class="color-chip" onclick="chipToggle(this,'color-sub',true)"><span class="cdot" style="background:#c9a882"></span>ãƒŸãƒ«ã‚¯ãƒ†ã‚£ãƒ¼</button>
      <button class="color-chip" onclick="chipToggle(this,'color-sub',true)"><span class="cdot" style="background:#e87030"></span>ã‚ªãƒ¬ãƒ³ã‚¸</button>
      <button class="color-chip" onclick="chipToggle(this,'color-sub',true)"><span class="cdot" style="background:#5a7a50"></span>ãƒ¢ã‚¹ã‚°ãƒªãƒ¼ãƒ³</button>
    </div>
    <input class="finput" id="color-sub-custom" placeholder="ãã®ä»–ã®ã‚µãƒ–ã‚«ãƒ©ãƒ¼ï¼ˆä»»æ„ï¼‰">
  </div>

  <!-- ç›®åœ°ã‚«ãƒ©ãƒ¼ -->
  <div class="field">
    <div class="field-label">ç›®åœ°ã‚«ãƒ©ãƒ¼</div>
    <input class="finput" id="f-grout" placeholder="ãƒ›ãƒ¯ã‚¤ãƒˆã€ã‚°ãƒ¬ãƒ¼ã€ãƒ–ãƒ©ãƒƒã‚¯ãªã©">
  </div>

  <!-- ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ -->
  <div class="field">
    <div class="field-label">ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ </div>
    <textarea class="finput" id="f-point" rows="3" placeholder="æ–½å·¥ã®ã“ã ã‚ã‚Šã‚„ç‰¹å¾´ã‚’å…¥åŠ›â€¦"></textarea>
    <button class="ex-btn" onclick="fillEx('f-point','ç›®åœ°å¹…ã‚’3mmã«çµ±ä¸€ã—ã€ä¸Šè³ªãªä»•ä¸ŠãŒã‚Šã‚’å®Ÿç¾ã€‚çŸ³ã®å‘ãã‚’æƒãˆã¦æ•´ç„¶ã¨ã—ãŸå°è±¡ã«ã€‚')">ä¾‹æ–‡ã‚’ä½¿ã†</button>
  </div>

  <!-- ãŠå®¢æ§˜ã®å£° -->
  <div class="field">
    <div class="field-label">ãŠå®¢æ§˜ã®å£° </div>
    <textarea class="finput" id="f-voice" rows="2" placeholder="ã€Œæƒ³åƒä»¥ä¸Šã®ä»•ä¸ŠãŒã‚Šã§å¤§æº€è¶³ã§ã™ï¼ã€ãªã©"></textarea>
    <button class="ex-btn" onclick="fillEx('f-voice','ã€Œæƒ³åƒä»¥ä¸Šã®ä»•ä¸ŠãŒã‚Šã§å¤§æº€è¶³ã§ã™ï¼è¿‘æ‰€ã®æ–¹ã«ã‚‚è¤’ã‚ã‚‰ã‚Œã¾ã—ãŸã€')">ä¾‹æ–‡ã‚’ä½¿ã†</button>
  </div>

  <!-- ãŠå®¢æ§˜ã®ãŠæ‚©ã¿ -->
  <div class="field">
    <div class="field-label">ãŠå®¢æ§˜ã®ãŠæ‚©ã¿ <span class="opt">ä»»æ„</span></div>
    <textarea class="finput" id="f-problem" rows="2" placeholder="ã€Œã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆãŒå‘³æ°—ãªãã¦ãŠã—ã‚ƒã‚Œã«ã—ãŸã‹ã£ãŸã€ãªã©"></textarea>
    <button class="ex-btn" onclick="fillEx('f-problem','ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆãŒå‘³æ°—ãªãã¦ãŠã—ã‚ƒã‚Œã«ã—ãŸã‹ã£ãŸ')">ä¾‹æ–‡ã‚’ä½¿ã†</button>
  </div>

  <!-- è‡ªç”±è¨˜è¿° -->
  <div class="field" style="border-radius:0 0 12px 12px;">
    <div class="field-label">ãã®ä»–ãƒ»è‡ªç”±è¨˜è¿° <span class="opt">ä»»æ„</span></div>
    <textarea class="finput" id="f-free" rows="2" placeholder="è‡ªç”±è¨˜å…¥"></textarea>
  </div>

  <!-- å†™çœŸã‚µãƒãƒªãƒ¼è¡¨ç¤º -->
  <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:12px 14px;font-size:12px;color:var(--text2);line-height:1.8;">
    ğŸ“¸ æ·»ä»˜äºˆå®šï¼šBefore <span style="color:var(--text);font-weight:700;">3</span>æš ï¼ é€ å½¢å¾Œ <span style="color:var(--text);font-weight:700;">2</span>æš ï¼ After <span style="color:var(--text);font-weight:700;">3</span>æš ï¼ â­ <span style="color:var(--text);font-weight:700;">2</span>æšã€€è¨ˆ <span style="color:var(--accent);font-weight:900;">10</span>æš
  </div>

</div><!-- form-body -->
<!-- å›ºå®šãƒœã‚¿ãƒ³ -->
<div class="fixed-btn">
  <button class="preview-btn" onclick="goPreview()">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ç¢ºèªã™ã‚‹ â†’</button>
</div>
</div><!-- screen-input -->


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN B: ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»é€ä»˜
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="screen" id="screen-preview">
<div class="preview-body">

  <div class="send-section-title">é€ä»˜ãƒ†ã‚­ã‚¹ãƒˆ</div>
  <div class="send-text-box" id="send-text-box"></div>

  <div class="steps-card">
    <div class="steps-title">2ã‚¹ãƒ†ãƒƒãƒ—ã§é€ä»˜</div>
    <div class="step-row"><span class="step-num">â‘ </span>ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ â†’ LINEã«è²¼ã‚Šä»˜ã‘</div>
    <div class="step-row"><span class="step-num">â‘¡</span>ZIPã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ â†’ LINEã«æ·»ä»˜</div>
  </div>

  <!-- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯æ¬„ -->
  <div style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:16px;margin-top:4px;">
    <div style="font-size:13px;font-weight:900;color:var(--text);margin-bottom:4px;">ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ğŸ‰</div>
    <div style="font-size:12px;color:var(--text2);line-height:1.8;margin-bottom:12px;">
      ä½¿ã„å¿ƒåœ°ã¯ã„ã‹ãŒã§ã—ãŸã‹ï¼Ÿ<br>ã‚ˆã‹ã£ãŸã‚‰ç°¡å˜ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ã€‚
    </div>
    <textarea class="finput" id="fb-text" rows="3" placeholder="ä¾‹ï¼‰å…¥åŠ›ãŒã‚¹ãƒ ãƒ¼ã‚ºã ã£ãŸãƒ»ã“ã“ãŒä½¿ã„ã«ãã‹ã£ãŸ ãªã©"></textarea>
    <div style="display:flex;gap:8px;margin-top:10px;">
      <button onclick="sendFeedback()" style="flex:1;padding:12px;background:var(--accent);color:#000;border:none;border-radius:10px;font-size:13px;font-weight:900;font-family:inherit;cursor:pointer;">
        ğŸ“¨ é€ä¿¡ã™ã‚‹
      </button>
      <button onclick="skipFeedback()" style="flex:1;padding:12px;background:transparent;color:var(--text2);border:1.5px solid var(--border);border-radius:10px;font-size:13px;font-weight:700;font-family:inherit;cursor:pointer;">
        ã‚¹ã‚­ãƒƒãƒ—
      </button>
    </div>
    <div id="fb-sent" style="display:none;text-align:center;padding:10px;font-size:12px;color:var(--ok);font-weight:700;">
      âœ… ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å—ã‘å–ã‚Šã¾ã—ãŸï¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™
    </div>
  </div>

</div>
<!-- å›ºå®šãƒœã‚¿ãƒ³ç¾¤ -->
<div class="fixed-actions">
  <button class="act-btn btn-copy" id="btn-copy" onclick="copyText()">ğŸ“‹ ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
  <button class="act-btn btn-zip"  onclick="downloadZip()">ğŸ“¦ ZIPã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
  <div style="display:flex;gap:8px;">
    <button class="act-btn btn-back"   onclick="goInput()">â† å†™çœŸã‚’è¿½åŠ ãƒ»ä¿®æ­£</button>
    <button class="act-btn btn-delete" onclick="confirmDelete()">ğŸ—‘ ã“ã®ç¾å ´ã‚’å‰Šé™¤</button>
  </div>
</div>
</div><!-- screen-preview -->

<div class="toast" id="toast-el"></div>

<script>
// â•â• çŠ¶æ…‹ â•â•
const state={
  title:'', titleCustom:'',
  size:'', days:'',
  baseYN:'yes', baseText:'',
  patterns:[], patternCustom:'',
  colorMain:[], colorMainCustom:'',
  colorSub:[], colorSubCustom:'',
  grout:'',
  point:'', voice:'', problem:'', free:''
};

// â•â• ãƒãƒƒãƒ—é¸æŠ â•â•
function chipToggle(btn, group, multi){
  if(!multi){
    // å˜ä¸€é¸æŠï¼šåŒã‚°ãƒ«ãƒ¼ãƒ—ã‚’å…¨è§£é™¤
    document.querySelectorAll(`#chips-${group} .chip, #chips-${group} .color-chip`).forEach(b=>b.classList.remove('on'));
  }
  btn.classList.toggle('on');
}

function setYN(v){
  document.getElementById('yn-yes').classList.toggle('on',v==='yes');
  document.getElementById('yn-no').classList.toggle('on',v==='no');
}
function setType(v){
  document.getElementById('type-rs').classList.toggle('on',v==='rs');
  document.getElementById('type-rw').classList.toggle('on',v==='rw');
}

function fillEx(id,text){
  document.getElementById(id).value=text;
  toast('ä¾‹æ–‡ã‚’å…¥åŠ›ã—ã¾ã—ãŸ');
}

// â•â• ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”Ÿæˆ â•â•
function buildSendText(){
  const title=getChips('chips-title') || document.getElementById('title-custom').value || 'ï¼ˆã‚¿ã‚¤ãƒˆãƒ«æœªå…¥åŠ›ï¼‰';
  const size=document.getElementById('f-size').value;
  const days=document.getElementById('f-days').value;
  const baseYN=document.getElementById('yn-yes').classList.contains('on')?'ã‚ã‚Š':'ãªã—';
  const baseText=document.getElementById('f-base').value;
  const patterns=[...getChipsArr('chips-pattern'), document.getElementById('pattern-custom').value].filter(Boolean).join('ã€');
  const colorMain=[...getChipsArr('chips-color-main'), document.getElementById('color-main-custom').value].filter(Boolean).join(' / ');
  const colorSub=[...getChipsArr('chips-color-sub'), document.getElementById('color-sub-custom').value].filter(Boolean).join(' / ');
  const grout=document.getElementById('f-grout').value;
  const point=document.getElementById('f-point').value;
  const voice=document.getElementById('f-voice').value;
  const problem=document.getElementById('f-problem').value;
  const free=document.getElementById('f-free').value;

  // ãƒ›ãƒ¼ãƒ æƒ…å ±
  const staff=document.getElementById('h-staff').value||'ï¼ˆæ‹…å½“è€…æœªå…¥åŠ›ï¼‰';
  const isRS=document.getElementById('type-rs').classList.contains('on');
  const typeName=isRS?'RollerStone':'RollerWall';

  let txt='';
  txt+=`ã€æ–½å·¥å ±å‘Šã€‘${typeName}\n`;
  txt+=`â—† ${title}\n`;
  txt+=`${'â”€'.repeat(18)}\n\n`;
  txt+=`â–  æ‹…å½“ï¼š${staff}\n`;
  txt+=`â–  æ—¥ä»˜ï¼š${new Date().toLocaleDateString('ja-JP',{year:'numeric',month:'numeric',day:'numeric'})}\n\n`;
  if(size)   txt+=`â–· è¦æ¨¡ï¼š${size}ã¡\n`;
  if(days)   txt+=`â–· æ–½å·¥æ—¥æ•°ï¼š${days}æ—¥\n`;
  txt+=`â–· ä¸‹åœ°å‡¦ç†ï¼š${baseYN}${baseText?' ï¼ˆ'+baseText+'ï¼‰':''}\n`;
  if(patterns) txt+=`â–· ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼š${patterns}\n`;
  if(colorMain){
    txt+=`â–· ä»•ä¸Šã’ã‚«ãƒ©ãƒ¼ï¼š${colorMain}`;
    if(colorSub) txt+=` / ã‚µãƒ–ï¼š${colorSub}`;
    txt+='\n';
  }
  if(grout)  txt+=`â–· ç›®åœ°ã‚«ãƒ©ãƒ¼ï¼š${grout}\n`;
  if(point)  txt+=`\nâ˜… ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ\n${point}\n`;
  if(voice)  txt+=`\nğŸ’¬ ãŠå®¢æ§˜ã®å£°\n${voice}\n`;
  if(problem)txt+=`\nğŸ˜Ÿ ãŠå®¢æ§˜ã®ãŠæ‚©ã¿\n${problem}\n`;
  if(free)   txt+=`\nğŸ“ ${free}\n`;
  txt+=`\n${'â”€'.repeat(18)}\n`;
  txt+=`ğŸ“· æ·»ä»˜ï¼š10æšï¼ˆBefore:3 é€ å½¢å¾Œ:2 After:3 â­:2ï¼‰`;
  return txt;
}

function getChips(containerId){
  const sel=[...document.querySelectorAll(`#${containerId} .on`)];
  return sel.map(b=>b.textContent.trim()).join('ãƒ»');
}
function getChipsArr(containerId){
  return [...document.querySelectorAll(`#${containerId} .on`)].map(b=>b.textContent.replace(/â—|â—‹|â–ª/g,'').trim());
}

function goPreview(){
  const txt=buildSendText();
  document.getElementById('send-text-box').textContent=txt;
  document.getElementById('screen-input').classList.remove('active');
  document.getElementById('screen-preview').classList.add('active');
  document.getElementById('hdr-right').textContent='ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼';
  window.scrollTo(0,0);
}

function goInput(){
  document.getElementById('screen-preview').classList.remove('active');
  document.getElementById('screen-input').classList.add('active');
  document.getElementById('hdr-right').textContent='å…¥åŠ›ä¸­';
  window.scrollTo(0,0);
}

// â•â• ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼ â•â•
function copyText(){
  const txt=document.getElementById('send-text-box').textContent;
  if(navigator.clipboard){
    navigator.clipboard.writeText(txt).then(()=>{
      const btn=document.getElementById('btn-copy');
      btn.textContent='âœ… ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼';
      btn.classList.add('copied-flash');
      setTimeout(()=>{btn.textContent='ğŸ“‹ ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼';btn.classList.remove('copied-flash');},2500);
    }).catch(()=>fallbackCopy(txt));
  } else { fallbackCopy(txt); }
}
function fallbackCopy(txt){
  const ta=document.createElement('textarea');
  ta.value=txt; ta.style.position='fixed'; ta.style.opacity='0';
  document.body.appendChild(ta); ta.select();
  document.execCommand('copy'); document.body.removeChild(ta);
  toast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
}

// â•â• ZIP ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ â•â•
async function downloadZip(){
  // JSZipãŒä½¿ãˆãªã„ç’°å¢ƒã®ãŸã‚ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’Blobã§ä¿å­˜
  // å®Ÿéš›ã¯JSZipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å†™çœŸè¾¼ã¿ZIPã‚’ç”Ÿæˆ
  const txt=document.getElementById('send-text-box').textContent;
  const blob=new Blob([txt],{type:'text/plain;charset=utf-8'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a');
  a.href=url;
  a.download=`RS_æ–½å·¥å ±å‘Š_${formatDate()}.txt`;
  a.click();
  URL.revokeObjectURL(url);
  toast('ğŸ“„ ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼ˆå®Ÿè£…æ™‚ã¯ZIPã§å†™çœŸã‚‚å«ã¿ã¾ã™ï¼‰');
}

function formatDate(){
  const d=new Date();
  return `${d.getFullYear()}${String(d.getMonth()+1).padStart(2,'0')}${String(d.getDate()).padStart(2,'0')}`;
}

function confirmDelete(){
  if(confirm('ã“ã®ç¾å ´ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\nâ€»ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“')){
    toast('ç¾å ´ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
    setTimeout(()=>goInput(),1000);
  }
}

// ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯é€ä¿¡ï¼ˆFormspreeï¼‰
async function sendFeedback(){
  const msg=document.getElementById('fb-text').value.trim();
  if(!msg){ toast('ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }
  const staff=document.getElementById('h-staff').value||'åŒ¿å';
  try{
    // Formspree endpointï¼ˆå®Ÿè£…æ™‚ã¯ https://formspree.io/f/YOUR_ID ã«å·®ã—æ›¿ãˆï¼‰
    const res=await fetch('https://formspree.io/f/xjkwgqpk',{
      method:'POST',
      headers:{'Content-Type':'application/json','Accept':'application/json'},
      body:JSON.stringify({
        message:msg,
        staff:staff,
        date:new Date().toLocaleDateString('ja-JP'),
        _subject:`RS-Reporter ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ from ${staff}`
      })
    });
    if(res.ok){
      document.getElementById('fb-sent').style.display='block';
      document.getElementById('fb-text').style.display='none';
      document.querySelector('[onclick="sendFeedback()"]').style.display='none';
      document.querySelector('[onclick="skipFeedback()"]').style.display='none';
    } else { throw new Error(); }
  } catch(e){
    // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ™‚ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¦ãƒˆãƒ¼ã‚¹ãƒˆ
    const saved=JSON.parse(localStorage.getItem('rs_fb')||'[]');
    saved.push({msg,staff,date:new Date().toISOString()});
    localStorage.setItem('rs_fb',JSON.stringify(saved));
    document.getElementById('fb-sent').style.display='block';
    document.getElementById('fb-text').style.display='none';
    document.querySelector('[onclick="sendFeedback()"]').style.display='none';
    document.querySelector('[onclick="skipFeedback()"]').style.display='none';
    toast('ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã®ãŸã‚ä¸€æ™‚ä¿å­˜ã—ã¾ã—ãŸ');
  }
}
function skipFeedback(){
  document.getElementById('fb-sent').style.display='none';
  document.getElementById('fb-text').style.display='none';
  document.querySelector('[onclick="sendFeedback()"]').style.display='none';
  document.querySelector('[onclick="skipFeedback()"]').style.display='none';
  const area=document.getElementById('fb-text').closest('div[style*="border-radius:14px"]');
  if(area) area.style.opacity='.4';
}

let tt;
function toast(msg){
  const el=document.getElementById('toast-el');
  el.textContent=msg;el.classList.add('show');
  clearTimeout(tt);tt=setTimeout(()=>el.classList.remove('show'),2500);
}
</script>
</body>
</html>
